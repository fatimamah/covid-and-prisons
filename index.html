<!DOCTYPE html>
<meta charset="UTF-8">
<title>Page Title</title>
<script src="https://d3js.org/d3.v6.min.js"></script>
<script src="https://d3js.org/topojson.v3.min.js"></script>


<body>
  <h1> Project 2</h1>
  <script>

    const requestData = async function() {

      const prison_data = await d3.csv("covid_prison_cases.csv");
      console.log(prison_data.length);
      console.log(prison_data);


      prison_data = prison_data.filter((d) => { return (d['total_prisoner_case']) != "" ; })
      console.log(prison_data.length);

      prison_data.forEach((d, i) => {
        d["as_of_date"] =  new Date(d["as_of_date"]);
        // if (d['total_prisoner_case']) = "" ){
        //   d['total_prisoner_case']) = 0;
        // };
        console.log(d["as_of_date"].getFullYear());
      });

      const groupBy = (array, key) => {
        return array.reduce((result, currentValue) => {
          (result[currentValue[key]] = result[currentValue[key]] || []).push(
            currentValue
          );
          return result;
        }, {});
      };

      var sorted_data = groupBy(prison_data, "name");




      console.log(sorted_data);



      //Date d = new Date(2011,11,30);




    }

    requestData();

    </script>


</body>


</html>
